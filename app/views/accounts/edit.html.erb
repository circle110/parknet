<%= render(:partial => 'shared/error_messages', :locals => {:object => @account}) %>
<%= link_to("<<Back to Account List", {:action => 'list'}, :class => 'back-link') %>

<div class="account update">
	<h2>Update Account</h2>
	<%= form_for @account, url: {controller: "accounts", action: "update"}, html: {class: "input_form"} do |f| %>
		<table summary="Staff User fields">
			<tr>
				<th>Account Status</th>
				<td><%= f.select(:account_status_id, options_for_select([["Active", "a"], ["Inactive", "i"], ["Deceased", "d"]]), prompt: "--Select Status--") %></td>
			</tr>
			<tr>
				<th>Account Email</th>
				<td><%= f.text_field(:email) %></td>
			</tr>		
			<tr>
				<th>Address</th>
				<td><%= f.text_field(:address) %></td>
			</tr>
			<tr>
				<th>Address 2</th>
				<td><%= f.text_field(:address_2) %></td>
			</tr>
			<tr>
				<th>City</th>
				<td><%= f.select(:city_id, City.all.collect {|c| [c.name, c.id]}) %></td>
			</tr>
			<tr>
				<th>State</th>
				<td><%= f.select(:state, options_for_select(us_states, :selected => @account.state)) %></td>
			</tr>
			<tr>
				<th>Zip</th>
				<td><%= f.text_field(:zip) %></td>
			</tr>
			<tr>
				<th>Resident Flag</th>
				<td><%= f.check_box(:resident_flag) %></td>
			</tr>
			<tr>
				<td colspan="2"><%= f.submit "Update Account" %>
				</td>
			</tr>
		</ table>

	<% end %>
	
		<tr>
		<td colspan="4"><h2>Account Members</h2> 
		<%= link_to("Add New Account Member", {:action => 'add_member	', :controller => 'customers', :account_id => @account.id, :agency_id => @account.agency_id}, 
		:class => 'add-customer-link') %> </td>
		<td colspan="5">&nbsp;
		</td>
	</tr>
		<tr>

	</tr>
	<tr>
		<th>Head Of Household</th>
		<th>First Name</th>
		<th>Last Name</th>
		<th>Age</th>
		<th>Birthday</th>
		<th>Actions</th>
	</tr>
		
		<% @account.customers.each do |customer| %>
			
			<tr>
				<td><%= customer.head_of_household_flag == 1 ? " âœ“ ":"" %></td>
				<td><%= customer.first_name %></td>
				<td><%= customer.last_name %></td>
				<td><%= distance_of_time_in_words(Time.now, customer.birthdate) %></td>
				<td><%= customer.birthdate.strftime("%b. %d, %Y") %></td>
				<td class="actions">
				<%= link_to("Edit", {:action => 'edit', :controller => 'customers', :id => customer.id}, :class => 'action_edit') %>
				</td>
			</tr>
		<% end %>
		
</ div>		